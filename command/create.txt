CREATE TABLE IF NOT EXISTS TABLE phong_ban (DNum INT(2) NOT NULL AUTO_INCREMENT, Mng_SSN VARCHAR(5) NOT NULL, Ten VARCHAR(20) NOT NULL, dia_chi VARCHAR(50) NOT NULL, so_nv INT(2) NOT NULL, PRIMARY KEY (Dnum));
LOAD DATA INFILE 'phong_ban.csv' INTO TABLE phong_ban FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 ROWS;

CREATE TABLE IF NOT EXISTS TABLE nhan_vien (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL, ho_ten VARCHAR(20) NOT NULL,DoB DATE,sdt INT,dia_chi VARCHAR(50), gioi_tinh VARCHAR(3),luong INT, PRIMARY KEY(SSN));
LOAD DATA INFILE 'nhan_vien.csv' INTO TABLE nhan_vien FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 ROWS;
ALTER IGNORE TABLE nhan_vien ADD UNIQUE (SSN);

CREATE TABLE IF NOT EXISTS ds_bang (SSN VARCHAR(5) REFERENCES nhan_vien(SSN) ,DID VARCHAR(50) NOT NULL, ngay_cap DATE, don_vi VARCHAR(50), PRIMARY KEY(SSN, DID));

CREATE TABLE IF NOT EXISTS nv_kinh_doanh (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL, chuc_vu VARCHAR(20), PRIMARY KEY(SSN));

CREATE TABLE IF NOT EXISTS nv_cskh (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL, PRIMARY KEY(SSN));

CREATE TABLE IF NOT EXISTS nv_ql_kho (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL, PRIMARY KEY(SSN));

CREATE TABLE IF NOT EXISTS doanh_nghiep (MST INT(13) NOT NULL, Email VARCHAR(255), Ten VARCHAR(50) , thoi_gian DATE, vote_rate INT(100), PRIMARY KEY(MST));

CREATE TABLE IF NOT EXISTS nv_ql_dn (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL, PRIMARY KEY(SSN));

CREATE TABLE IF NOT EXISTS nv_shipper (SSN VARCHAR(5) NOT NULL,Dnum INT(2) NOT NULL,ca_lam VARCHAR(10), PRIMARY KEY(SSN));

CREATE TABLE IF NOT EXISTS ql_dn (SSN VARCHAR(5) REFERENCES nhan_vien(SSN) ,MST INT(13) REFERENCES doanh_nghiep(MST), PRIMARY KEY(SSN, MST));

CREATE TABLE IF NOT EXISTS hang (SKU VARCHAR(8) NOT NULL,ten VARCHAR(50) NOT NULL,mo_ta VARCHAR(100),gia_hien_tai INT(10),gia_truoc_day INT(10) NOT NULL,bao_hanh INT , PRIMARY KEY(SKU));

CREATE TABLE IF NOT EXISTS ds_loai_hang (loai VARCHAR(50), SKU VARCHAR(8) REFERENCES hang(SKU), PRIMARY KEY(SKU));

CREATE TABLE IF NOT EXISTS ds_hang_hoa (MST INT(13) REFERENCES doanh_nghiep(MST), SKU VARCHAR(8) REFERENCES hang(SKU), xuat_xu VARCHAR(50), so_luong INT, PRIMARY KEY(MST, SKU));

CREATE TABLE IF NOT EXISTS hang_het (SKU VARCHAR(8) REFERENCES hang(SKU), PRIMARY KEY(SKU));

CREATE TABLE IF NOT EXISTS hang_con (SKU VARCHAR(8) REFERENCES hang(SKU), so_luong INT, PRIMARY KEY(SKU));

CREATE TABLE IF NOT EXISTS khach_hang (ID VARCHAR(5) NOT NULL,Email VARCHAR(255),ho_ten VARCHAR(20),dia_chi VARCHAR(50),sdt INT, PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS ds_hang_mua (ID VARCHAR(5) REFERENCES khach_hang(ID),ma_gio VARCHAR(10),so_luong INT,SKU VARCHAR(8), PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS gio_hang (ID VARCHAR(5) REFERENCES khach_hang(ID), ma_gio VARCHAR(10), so_luong INT, tong_tien INT, ds_hang_mua VARCHAR(5), PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS hang_mua (ID VARCHAR(5) REFERENCES khach_hang(ID), ma_gio VARCHAR(10), SKU VARCHAR(8), PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS khach_vang_lai (ID VARCHAR(5), PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS thanh_vien (ID VARCHAR(5),DoB DATE,gioi_tinh VARCHAR(3), PRIMARY KEY(ID));

CREATE TABLE IF NOT EXISTS mua_ngay (ma_don VARCHAR(10),ID VARCHAR(5),ma_gio VARCHAR(10),ngay_mua DATE, ngay_tra DATE,tinh_trang_don VARCHAR(50), PRIMARY KEY(ma_don));

CREATE TABLE IF NOT EXISTS Coupon (Code VARCHAR(12),MST INT(13), ID VARCHAR(5),thoi_han DATE, loai_hang VARCHAR(8),chiet_khau INT, PRIMARY KEY(Code));

CREATE TABLE IF NOT EXISTS nhan_xet (ID VARCHAR(5) REFERENCES khach_hang(ID),SKU VARCHAR(8) REFERENCES hang(SKU),noi_dung VARCHAR(500),diem INT , PRIMARY KEY(ID, SKU));

===============================================================================

ALTER TABLE phong_ban ADD FOREIGN KEY (`Mng_SSN`) REFERENCES nhan_vien(`SSN`);
ALTER TABLE nhan_vien ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE nv_kinh_doanh ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE nv_shipper ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE nv_cskh ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE nv_ql_kho ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE doanh_nghiep ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
ALTER TABLE doanh_nghiep ADD FOREIGN KEY (`DNum`) REFERENCES phong_ban(`DNum`);
